<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="valen.css">
    <title>For My Love</title>
</head>
<body>

</head>

<body>

    <!-- Background Shapes -->
    <div class="bg-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <!-- Game Stage -->
    <div id="game-stage">
        <div class="instructions">
            <h1>Find My Heart</h1>
            <p>I've hidden 3 hearts inside these gifts and surprises.<br>Click them to find where my heart lies!</p>
            <div class="score-board">Hearts Found: <span id="counter">0</span>/3</div>
        </div>

        <!-- Hiding Spots Container -->
        <div class="hiding-spots-container">
            <!-- Generated by JS -->
        </div>
    </div>

    <!-- Envelope Stage -->
    <div id="envelope-stage">
        <div class="envelope-container" id="envelope">
            <div class="envelope">
                <div class="pocket"></div>
                <!-- The letter inside -->
                <div class="letter-preview"></div>
                <div class="flap"></div>
                <div class="seal">‚ù§Ô∏è</div>
            </div>
        </div>
        <button class="open-btn" onclick="openEnvelope()">Open Me</button>
    </div>

    <!-- Full Letter View -->
    <div id="letter-view">
        <div class="love-letter">
            <button class="close-btn" onclick="closeLetter()">√ó</button>
            <h2>My Dearest Valentine,</h2>
            <p>Just like you found these hidden hearts, you've found the deepest parts of my soul.</p>
            <p>Every moment with you is a surprise I cherish, a gift I never want to stop opening.</p>
            <p>Thank you for being my adventure, my comfort, and my love.</p>
            <p>Happy Valentine's Day! ‚ù§Ô∏è</p>
            <p style="text-align: right;">- Yours forever</p>
        </div>
    </div>


    <script>
        let heartsFound = 0;
        const totalHearts = 3;

        // Items to hide things in
        const hidingItems = ['üéÅ', 'üéÅ', 'üéÅ', 'üß∏', 'üß∏', 'üíê', 'üíê', '‚òÅÔ∏è', 'üíå', 'üç¨', 'üßÅ', 'üåπ'];
        let spots = [];

        window.onload = function () {
            initGame();
        };

        function initGame() {
            const container = document.querySelector('.hiding-spots-container');
            // Shuffle items
            hidingItems.sort(() => Math.random() - 0.5);

            // Limit to maybe 12 items on screen for clean look
            const displayItems = hidingItems.slice(0, 12);

            // Pick 3 random indices to hold hearts
            let heartIndices = new Set();
            while (heartIndices.size < 3) {
                heartIndices.add(Math.floor(Math.random() * displayItems.length));
            }

            displayItems.forEach((icon, index) => {
                const spot = document.createElement('div');
                spot.classList.add('hiding-spot');
                spot.innerText = icon;
                spot.dataset.hasHeart = heartIndices.has(index);
                spot.onclick = () => checkSpot(spot);
                container.appendChild(spot);
                spots.push(spot);
            });
        }

        function checkSpot(element) {
            if (element.classList.contains('shaking') || element.classList.contains('revealed')) return;

            if (element.dataset.hasHeart === "true") {
                // FOUND HEART
                element.classList.add('revealed');

                // Show floating heart
                const heart = document.createElement('div');
                heart.classList.add('hidden-heart-popup', 'pop-anim');
                heart.innerText = '‚ù§Ô∏è';
                element.appendChild(heart);

                // Sparkles at position
                const rect = element.getBoundingClientRect();
                createSparkles(rect.left + rect.width / 2, rect.top + rect.height / 2);

                heartsFound++;
                document.getElementById('counter').innerText = heartsFound;

                if (heartsFound === totalHearts) {
                    setTimeout(revealEnvelope, 1200);
                }
            } else {
                // EMPTY
                element.classList.add('shaking');
                // Optional: Change emoji to empty/sad or just fade
                // element.style.opacity = '0.5';
            }
        }

        function createSparkles(x, y) {
            for (let i = 0; i < 8; i++) {
                const sparkle = document.createElement('div');
                sparkle.classList.add('sparkle');
                sparkle.innerText = '‚ú®';
                sparkle.style.left = (x + (Math.random() * 40 - 20)) + 'px';
                sparkle.style.top = (y + (Math.random() * 40 - 20)) + 'px';
                document.body.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 800);
            }
        }

        function revealEnvelope() {
            const gameStage = document.getElementById('game-stage');
            const envelopeStage = document.getElementById('envelope-stage');

            gameStage.classList.add('hidden');

            setTimeout(() => {
                gameStage.style.display = 'none';
                envelopeStage.style.display = 'flex';
                void envelopeStage.offsetWidth;
                envelopeStage.classList.add('visible');
            }, 1000);
        }

        function openEnvelope() {
            const envContainer = document.getElementById('envelope');
            const letterView = document.getElementById('letter-view');
            envContainer.classList.add('open');
            setTimeout(() => {
                letterView.classList.add('active');
                createConfetti();
            }, 1500);
        }

        function closeLetter() {
            document.getElementById('letter-view').classList.remove('active');
        }

        function createConfetti() {
            const colors = ['#ff4d6d', '#ff8fa3', '#fff', '#gold'];
            for (let i = 0; i < 50; i++) {
                const conf = document.createElement('div');
                conf.style.position = 'fixed';
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.top = -10 + 'px';
                conf.style.width = '10px';
                conf.style.height = '10px';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.animation = `float ${Math.random() * 3 + 2}s linear forwards`;
                document.body.appendChild(conf);
                setTimeout(() => conf.remove(), 5000);
            }
        }
    </script>
</body>
</html>